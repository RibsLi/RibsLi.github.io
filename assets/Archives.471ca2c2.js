import{_ as e,u as a}from"./index.07ca67da.js";import{q as l}from"./query.1a7bdd6e.js";import{r as t,a4 as o,a5 as s,x as r,o as n,c as u,q as c,y as i,f as v,F as d,e as p,b as h,t as f,s as g,l as m,k as y,A as x}from"./vendor.1b44fe95.js";const _={key:0,class:"content"};var b=e({setup(e){const{proxy:b}=x(),C=a(),k=t({state:"open",page:1,per_page:12});let $=t([]),j=t(),q=t(!1),A=t(!1),T=t(!1),B=t(),H=t();o((()=>B.value.scrollTop=H.value)),s((()=>H.value=B.value.scrollTop));const I=()=>async function(){b.$blogApi.resolve("getArticle",k.value).then((e=>{q.value=!1,(null==e?void 0:e.length)?(e.length<12?A.value=!0:k.value.page++,e.forEach((e=>{const a=e.created_at.split("-"),l=a[0]+"年"+a[1]+"月";let t=!1;e.created_at=b.$format(e.created_at,"zh_CN").replace(/\s/,"");const o=Math.floor(Math.random()*C.themeColors.length);if(e.color=C.themeColors[o],$.value){for(let a=0;a<$.value.length;a++)if(l===$.value[a].ym){t=!0,$.value[a].data.push(e),$.value[a].color=C.themeColors[o];break}t||$.value.push({ym:l,data:[e]})}else $.value=[{ym:l,data:[e]}]}))):(null==e?void 0:e.length)?(T.value=!0,q.value=!1):A.value=!0})).catch((e=>{b.$toast(`请求失败${e}`),T.value=!0,q.value=!1}))}();l().then((e=>{j.value=null==e?void 0:e.repository.issues.totalCount}));const L=()=>{C.scrollBox=B.value;const e=B.value.scrollHeight-B.value.offsetHeight,a=B.value.scrollTop;C.percentage=parseInt(a/e*100)};return(e,a)=>{const l=r("CompList"),t=r("van-list");return n(),u("div",{class:"content-box",ref_key:"scrollBox",ref:B,onScroll:L},[c(t,{loading:v(q),"onUpdate:loading":a[0]||(a[0]=e=>y(q)?q.value=e:q=e),error:v(T),"onUpdate:error":a[1]||(a[1]=e=>y(T)?T.value=e:T=e),finished:v(A),"finished-text":`总共 ${v(j)} 条，没有了哦 ฅ ̳͒•ˑ̫• ̳͒ฅ`,"error-text":"请求失败，点击重新加载",onLoad:I},{default:i((()=>[v($).length?(n(),u("div",_,[(n(!0),u(d,null,p(v($),((e,a)=>(n(),u("div",{class:"list",key:a},[h("div",{class:"timeline",style:g({backgroundColor:e.color})},f(e.ym),5),c(l,{list:e.data},null,8,["list"])])))),128))])):m("",!0)])),_:1},8,["loading","error","finished","finished-text"])],544)}}},[["__scopeId","data-v-dcb75cdc"]]);export{b as default};
