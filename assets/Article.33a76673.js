import{a as e,r as l,a4 as a,a5 as t,x as s,a6 as o,o as r,c as i,q as n,y as c,f as u,F as d,e as v,i as m,b as g,m as h,t as p,g as f,l as b,k,A as y}from"./vendor.1b44fe95.js";import{_ as C,u as x}from"./index.bc80a632.js";import{q as _}from"./query.61bcec18.js";const M={key:0,class:"content"},D=["onClick"],U={class:"title"},j=["onClick"],q={class:"info txt-ell-one"},$=["onClick"],I={key:0,class:"label-list"},S=["onClick"],A={class:"description txt-ell-one"},T={key:1};var z=C({setup(C){const{proxy:z}=y(),B=x(),H=e(),L=l({state:"open",page:1,per_page:12});let N=l([]),P=l(),w=l(!1),E=l(!1),F=l(!1),J=l(),O=l();a((()=>J.value.scrollTop=O.value)),t((()=>O.value=J.value.scrollTop));const G=()=>async function(){z.$blogApi.resolve("getArticle",L.value).then((e=>{w.value=!1,(null==e?void 0:e.length)?(e.length<12?E.value=!0:L.value.page++,e.forEach((e=>{e.created_at=z.$format(e.created_at,"zh_CN").replace(/\s/,"");const l=/^\[(.+)\].*(http.*(?:jpg|jpeg|png|gif))/,a=/^(.+)?\r\n\s*(.+)?\r\n/.exec(e.body),t=Math.floor(Math.random()*B.images.length),s=Math.floor(Math.random()*B.defaultDes.length),o=Math.floor(Math.random()*B.themeColors.length);if(a&&a.length>=2){const r=l.exec(a[1]);r&&3===r.length?(e.description=r[1],e.imgUrl=r[2],e.color=B.themeColors[o]):(e.description=B.defaultDes[s],e.imgUrl=B.images[t],e.color=B.themeColors[o])}else e.description=B.defaultDes[s],e.imgUrl=B.images[t],e.color=B.themeColors[o]})),N.value.push(...e)):(null==e?void 0:e.length)?(F.value=!0,w.value=!1):E.value=!0})).catch((e=>{z.$toast(`请求失败${e}`),F.value=!0,w.value=!1}))}();_().then((e=>{P.value=null==e?void 0:e.repository.issues.totalCount}));const K=e=>{H.push({path:"/articleDetail",query:{num:e}})},Q=()=>H.push("/archives"),R=()=>{B.scrollBox=J.value;const e=J.value.scrollHeight-J.value.offsetHeight,l=J.value.scrollTop;B.percentage=parseInt(l/e*100)};return(e,l)=>{const a=s("van-icon"),t=s("CompList"),y=s("van-list"),C=o("lazy");return r(),i("div",{class:"content-box",ref_key:"scrollBox",ref:J,onScroll:R},[n(y,{loading:u(w),"onUpdate:loading":l[0]||(l[0]=e=>k(w)?w.value=e:w=e),error:u(F),"onUpdate:error":l[1]||(l[1]=e=>k(F)?F.value=e:F=e),finished:u(E),"finished-text":`总共 ${u(P)} 条，没有了哦 ฅ ̳͒•ˑ̫• ̳͒ฅ`,"error-text":"请求失败，点击重新加载",onLoad:G},{default:c((()=>[u(N).length&&!u(B).PureMode?(r(),i("div",M,[(r(!0),i(d,null,v(u(N),(e=>(r(),i("div",{class:"list",key:e.number},[m(g("img",{class:"bg-img cursor hvr-wobble-vertical",onClick:h((l=>K(e.number)),["self"])},null,8,D),[[C,e.imgUrl]]),g("div",U,[g("div",{class:"name cursor txt-ell-one",onClick:h((l=>K(e.number)),["self"])},p(e.title),9,j),g("div",q,[g("div",{class:"info-item cursor",onClick:Q},[n(a,{name:"notes-o"}),f(" "+p(e.created_at),1)]),g("div",{class:"info-item cursor",onClick:l=>{return a=e.milestone,localStorage.setItem("categories",JSON.stringify(a)),void H.push("/listDetail");var a}},[n(a,{name:"apps-o"}),f(" "+p(e.milestone.title?e.milestone.title:"暂无分类"),1)],8,$),e.labels?(r(),i("div",I,[n(a,{name:"label-o"}),(r(!0),i(d,null,v(e.labels,((e,l)=>(r(),i("div",{class:"label-item cursor",key:l,onClick:l=>(e=>{localStorage.removeItem("categories"),H.push({path:"/listDetail",query:{name:e.name}})})(e)},p(e.name),9,S)))),128))])):b("",!0)]),g("div",A,p(e.description),1)])])))),128))])):b("",!0),u(N).length&&u(B).PureMode?(r(),i("div",T,[n(t,{list:u(N)},null,8,["list"])])):b("",!0)])),_:1},8,["loading","error","finished","finished-text"])],544)}}},[["__scopeId","data-v-fee59fd0"]]);export{z as default};
