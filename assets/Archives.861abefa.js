import{_ as e,u as a}from"./index.e2668ecf.js";import{q as l}from"./query.f5fbfdce.js";import{r as t,a4 as o,a5 as s,i as r,o as n,c as u,j as c,k as i,f as v,F as d,e as f,b as p,t as h,q as g,z as m,m as y,s as _}from"./vendor.f01c9790.js";const x={key:0,class:"content"};var C=e({setup(e){const{proxy:C}=_(),b=a(),k=t({state:"open",page:1,per_page:12});let $=t([]),j=t(),q=t(!1),T=t(!1),z=t(!1),A=t(),B=t();o((()=>A.value.scrollTop=B.value)),s((()=>B.value=A.value.scrollTop));const H=()=>async function(){C.$blogApi.resolve("getArticle",k.value).then((e=>{q.value=!1,(null==e?void 0:e.length)?(e.length<12?T.value=!0:k.value.page++,e.forEach((e=>{const a=e.created_at.split("-"),l=a[0]+"年"+a[1]+"月";let t=!1;e.created_at=C.$format(e.created_at,"zh_CN").replace(/\s/,"");const o=Math.floor(Math.random()*b.themeColors.length);if(e.color=b.themeColors[o],$.value){for(let a=0;a<$.value.length;a++)if(l===$.value[a].ym){t=!0,$.value[a].data.push(e),$.value[a].color=b.themeColors[o];break}t||$.value.push({ym:l,data:[e]})}else $.value=[{ym:l,data:[e]}]}))):(null==e?void 0:e.length)?(z.value=!0,q.value=!1):T.value=!0})).catch((e=>{C.$toast(`请求失败${e}`),z.value=!0,q.value=!1}))}();l().then((e=>{j.value=null==e?void 0:e.repository.issues.totalCount}));const I=()=>{b.scrollBox=A.value;const e=A.value.scrollHeight-A.value.offsetHeight,a=A.value.scrollTop;b.percentage=parseInt(a/e*100)};return(e,a)=>{const l=r("CompList"),t=r("van-list");return n(),u("div",{class:"content-box",ref_key:"scrollBox",ref:A,onScroll:I},[c(t,{loading:v(q),"onUpdate:loading":a[0]||(a[0]=e=>y(q)?q.value=e:q=e),error:v(z),"onUpdate:error":a[1]||(a[1]=e=>y(z)?z.value=e:z=e),finished:v(T),"finished-text":`总共 ${v(j)} 条，没有了哦 ฅ ̳͒•ˑ̫• ̳͒ฅ`,"error-text":"请求失败，点击重新加载",onLoad:H},{default:i((()=>[v($).length?(n(),u("div",x,[(n(!0),u(d,null,f(v($),((e,a)=>(n(),u("div",{class:"list",key:a},[p("div",{class:"timeline",style:g({backgroundColor:e.color})},h(e.ym),5),c(l,{list:e.data},null,8,["list"])])))),128))])):m("",!0)])),_:1},8,["loading","error","finished","finished-text"])],544)}}},[["__scopeId","data-v-d57644e0"]]);export{C as default};
