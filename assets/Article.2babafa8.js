import{a as z,r as n,a3 as I,a4 as E,i as S,a5 as F,o as c,c as u,j as x,k as O,F as T,f as U,C as R,b as d,s as q,e as s,t as _,g as M,y as w,q as J}from"./vendor.0f7bf07e.js";import{_ as Y,u as G}from"./index.f8926bac.js";import{q as K}from"./query.80de4030.js";const P={key:0,class:"content"},Q=["onClick"],W={class:"title"},X=["onClick"],Z={class:"info txt-ell-one"},ee=["onClick"],te={key:0,class:"label-list"},le=["onClick"],oe={class:"description txt-ell-one"},se={setup(ae){let{proxy:C}=J(),a=G(),h=z(),b=n({state:"open",page:1,per_page:12}),k=n([]),D=n(),g=n(!1),y=n(!1),m=n(!1),r=n(),$=n();I(()=>r.value.scrollTop=$.value),E(()=>$.value=r.value.scrollTop);async function H(){C.$blogApi.resolve("getArticle",b.value).then(e=>{console.log("\u6587\u7AE0\u5217\u8868",e),g.value=!1,e!=null&&e.length?(e.length<12?y.value=!0:b.value.page++,e.forEach(l=>{l.created_at=C.$format(l.created_at,"zh_CN").replace(/\s/,"");const i=/^(.+)?\r\n\s*(.+)?\r\n/,p=/^\[(.+)\].*(http.*(?:jpg|jpeg|png|gif))/,f=i.exec(l.body),t=Math.floor(Math.random()*a.images.length),o=Math.floor(Math.random()*a.defaultDes.length);if(f&&f.length>=2){const v=p.exec(f[1]);v&&v.length===3?(l.description=v[1],l.imgUrl=v[2]):(l.description=a.defaultDes[o],l.imgUrl=a.images[t])}else l.description=a.defaultDes[o],l.imgUrl=a.images[t]}),k.value.push(...e)):e!=null&&e.length?(m.value=!0,g.value=!1):y.value=!0}).catch(e=>{console.log("======\u8BF7\u6C42\u5931\u8D25======",e),C.$toast(`\u8BF7\u6C42\u5931\u8D25${e}`),m.value=!0,g.value=!1})}let L=()=>H();K().then(e=>{console.log("\u6587\u7AE0\u603B\u6570",e),D.value=e==null?void 0:e.repository.issues.totalCount});let A=e=>{h.push({path:"/articleDetail",query:{num:e}})},B=()=>h.push("/archives"),V=e=>{console.log(e),localStorage.setItem("categories",JSON.stringify(e)),h.push("/listDetail")},j=e=>{console.log(e),localStorage.removeItem("categories"),h.push({path:"/listDetail",query:{name:e.name}})},N=()=>{console.log("=="),a.scrollBox=r.value;const e=r.value.scrollHeight,l=r.value.offsetHeight,i=e-l,p=r.value.scrollTop;a.percentage=parseInt(p/i*100)};return(e,l)=>{const i=S("van-icon"),p=S("van-list"),f=F("lazy");return c(),u("div",{class:"content-box",ref_key:"scrollBox",ref:r,onScroll:l[3]||(l[3]=(...t)=>s(N)&&s(N)(...t))},[x(p,{loading:g.value,"onUpdate:loading":l[1]||(l[1]=t=>g.value=t),finished:y.value,"finished-text":`\u603B\u5171 ${D.value} \u6761\uFF0C\u6CA1\u6709\u4E86\u54E6 \u0E05 \u0333\u0352\u2022\u02D1\u032B\u2022 \u0333\u0352\u0E05`,error:m.value,"onUpdate:error":l[2]||(l[2]=t=>m.value=t),"error-text":"\u8BF7\u6C42\u5931\u8D25\uFF0C\u70B9\u51FB\u91CD\u65B0\u52A0\u8F7D",onLoad:s(L)},{default:O(()=>[k.value.length?(c(),u("div",P,[(c(!0),u(T,null,U(k.value,t=>(c(),u("div",{class:"list",key:t.number},[R(d("img",{class:"bg-img cursor hvr-wobble-vertical",onClick:q(o=>s(A)(t.number),["self"])},null,8,Q),[[f,t.imgUrl]]),d("div",W,[d("div",{class:"name cursor txt-ell-one",onClick:q(o=>s(A)(t.number),["self"])},_(t.title),9,X),d("div",Z,[d("div",{class:"info-item cursor",onClick:l[0]||(l[0]=(...o)=>s(B)&&s(B)(...o))},[x(i,{name:"notes-o"}),M(" "+_(t.created_at),1)]),d("div",{class:"info-item cursor",onClick:o=>s(V)(t.milestone)},[x(i,{name:"apps-o"}),M(" "+_(t.milestone.title?t.milestone.title:"\u6682\u65E0\u5206\u7C7B"),1)],8,ee),t.labels?(c(),u("div",te,[x(i,{name:"label-o"}),(c(!0),u(T,null,U(t.labels,(o,v)=>(c(),u("div",{class:"label-item cursor",key:v,onClick:ne=>s(j)(o)},_(o.name),9,le))),128))])):w("",!0)]),d("div",oe,_(t.description),1)])]))),128))])):w("",!0)]),_:1},8,["loading","finished","finished-text","error","onLoad"])],544)}}};var ue=Y(se,[["__scopeId","data-v-d4897148"]]);export{ue as default};
