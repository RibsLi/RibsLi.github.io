import{a as e,r as l,a3 as a,a4 as s,i as t,a5 as o,o as i,c as n,j as r,k as c,F as u,f as v,C as d,b as p,s as g,e as m,t as f,g as h,y as b,q as k}from"./vendor.43b10751.js";import{_ as y,u as x}from"./index.7b0a0220.js";import{q as C}from"./query.6f2f4b62.js";const _={key:0,class:"content"},j=["onClick"],D={class:"title"},U=["onClick"],q={class:"info txt-ell-one"},$=["onClick"],I={key:0,class:"label-list"},M=["onClick"],S={class:"description txt-ell-one"};var T=y({setup(y){let{proxy:T}=k(),z=x(),A=e(),B=l({state:"open",page:1,per_page:12}),H=l([]),L=l(),N=l(!1),w=l(!1),E=l(!1),F=l(),J=l();a((()=>F.value.scrollTop=J.value)),s((()=>J.value=F.value.scrollTop));let O=()=>async function(){T.$blogApi.resolve("getArticle",B.value).then((e=>{N.value=!1,(null==e?void 0:e.length)?(e.length<12?w.value=!0:B.value.page++,e.forEach((e=>{e.created_at=T.$format(e.created_at,"zh_CN").replace(/\s/,"");const l=/^\[(.+)\].*(http.*(?:jpg|jpeg|png|gif))/,a=/^(.+)?\r\n\s*(.+)?\r\n/.exec(e.body),s=Math.floor(Math.random()*z.images.length),t=Math.floor(Math.random()*z.defaultDes.length);if(a&&a.length>=2){const o=l.exec(a[1]);o&&3===o.length?(e.description=o[1],e.imgUrl=o[2]):(e.description=z.defaultDes[t],e.imgUrl=z.images[s])}else e.description=z.defaultDes[t],e.imgUrl=z.images[s]})),H.value.push(...e)):(null==e?void 0:e.length)?(E.value=!0,N.value=!1):w.value=!0})).catch((e=>{T.$toast(`请求失败${e}`),E.value=!0,N.value=!1}))}();C().then((e=>{L.value=null==e?void 0:e.repository.issues.totalCount}));let G=e=>{A.push({path:"/articleDetail",query:{num:e}})},K=()=>A.push("/archives"),P=e=>{localStorage.setItem("categories",JSON.stringify(e)),A.push("/listDetail")},Q=e=>{localStorage.removeItem("categories"),A.push({path:"/listDetail",query:{name:e.name}})},R=()=>{z.scrollBox=F.value;const e=F.value.scrollHeight-F.value.offsetHeight,l=F.value.scrollTop;z.percentage=parseInt(l/e*100)};return(e,l)=>{const a=t("van-icon"),s=t("van-list"),k=o("lazy");return i(),n("div",{class:"content-box",ref_key:"scrollBox",ref:F,onScroll:l[3]||(l[3]=(...e)=>m(R)&&m(R)(...e))},[r(s,{loading:N.value,"onUpdate:loading":l[1]||(l[1]=e=>N.value=e),error:E.value,"onUpdate:error":l[2]||(l[2]=e=>E.value=e),finished:w.value,"finished-text":`总共 ${L.value} 条，没有了哦 ฅ ̳͒•ˑ̫• ̳͒ฅ`,"error-text":"请求失败，点击重新加载",onLoad:m(O)},{default:c((()=>[H.value.length?(i(),n("div",_,[(i(!0),n(u,null,v(H.value,(e=>(i(),n("div",{class:"list",key:e.number},[d(p("img",{class:"bg-img cursor hvr-wobble-vertical",onClick:g((l=>m(G)(e.number)),["self"])},null,8,j),[[k,e.imgUrl]]),p("div",D,[p("div",{class:"name cursor txt-ell-one",onClick:g((l=>m(G)(e.number)),["self"])},f(e.title),9,U),p("div",q,[p("div",{class:"info-item cursor",onClick:l[0]||(l[0]=(...e)=>m(K)&&m(K)(...e))},[r(a,{name:"notes-o"}),h(" "+f(e.created_at),1)]),p("div",{class:"info-item cursor",onClick:l=>m(P)(e.milestone)},[r(a,{name:"apps-o"}),h(" "+f(e.milestone.title?e.milestone.title:"暂无分类"),1)],8,$),e.labels?(i(),n("div",I,[r(a,{name:"label-o"}),(i(!0),n(u,null,v(e.labels,((e,l)=>(i(),n("div",{class:"label-item cursor",key:l,onClick:l=>m(Q)(e)},f(e.name),9,M)))),128))])):b("",!0)]),p("div",S,f(e.description),1)])])))),128))])):b("",!0)])),_:1},8,["loading","error","finished","finished-text","onLoad"])],544)}}},[["__scopeId","data-v-65f1bc82"]]);export{T as default};
