import{r as e,a3 as a,a4 as t,q as l,o,c as r,s,v as n,f as i,F as u,e as d,b as c,t as v,k as p,x as f,j as b,i as h,y as g}from"./vendor.662b62b4.js";import{_ as m,u as y}from"./index.2dc9f4ee.js";import{q as x}from"./query.a46c247c.js";const _={class:"grid gap-15 grid-cols-3 box"};var k=m({setup(m){const{proxy:k}=g(),$=y(),j=e({state:"open",page:1,per_page:12});let w=e([]),C=e(),q=e(!1),A=e(!1),T=e(!1),B=e(),H=e();a((()=>B.value.scrollTop=H.value)),t((()=>H.value=B.value.scrollTop));const I=()=>{k.$blogApi.resolve("getArticle",j.value).then((e=>{q.value=!1,(null==e?void 0:e.length)?(e.length<12?A.value=!0:j.value.page++,e.forEach((e=>{const a=e.created_at.split("-"),t=a[0]+"年"+a[1]+"月";let l=!1;e.created_at=k.$format(e.created_at,"zh_CN").replace(/\s/,"");const o=Math.floor(Math.random()*$.palette.length);if(e.color=$.palette[o],w.value){for(let a=0;a<w.value.length;a++)if(t===w.value[a].ym){l=!0,w.value[a].data.push(e),w.value[a].color=$.palette[o];break}l||w.value.push({ym:t,data:[e]})}else w.value=[{ym:t,data:[e]}]}))):(null==e?void 0:e.length)?(T.value=!0,q.value=!1):A.value=!0})).catch((e=>{k.$toast(`请求失败${e}`),T.value=!0,q.value=!1}))};x().then((e=>C.value=null==e?void 0:e.repository.issues.totalCount));const M=()=>{$.scrollBox=B.value;const e=B.value.scrollHeight-B.value.offsetHeight,a=B.value.scrollTop;$.percentage=parseInt(a/e*100)};return(e,a)=>{const t=l("ArticleCard"),g=l("van-list");return o(),r("div",{class:"vanlist p-15 overflow-auto fixed top-60 left-0 right-0 bottom-0",ref_key:"scrollBox",ref:B,onScroll:M},[s(g,{loading:i(q),"onUpdate:loading":a[0]||(a[0]=e=>h(q)?q.value=e:q=e),error:i(T),"onUpdate:error":a[1]||(a[1]=e=>h(T)?T.value=e:T=e),finished:i(A),"finished-text":`总共 ${i(C)} 条，没有了哦 ฅ ̳͒•ˑ̫• ̳͒ฅ`,"error-text":"请求失败，点击重新加载",onLoad:I},{default:n((()=>[i(w).length?(o(!0),r(u,{key:0},d(i(w),((e,a)=>(o(),r("div",{class:"bg-white/70 mb-15 ml-15 rounded-5 p-15 pt-60 relative",key:a},[c("div",{class:"w-120 h-30 lh-30 absolute top-15 left--15 text-center text-white rounded-r-5 bg-primary select-none before:content-none before:inline-block before:absolute before:top-30 before:left-0 before:border-t-15 before:border-t-divider-1 before:border-l-15 before:border-l-transparent",style:p({backgroundColor:e.color})},v(e.ym),5),c("div",_,[(o(!0),r(u,null,d(e.data,(e=>(o(),f(t,{key:e.id,article:e},null,8,["article"])))),128))])])))),128)):b("v-if",!0)])),_:1},8,["loading","error","finished","finished-text"])],544)}}},[["__scopeId","data-v-7c3c4e45"]]);export{k as default};
